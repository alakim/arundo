define(["html", "knockout", "dataSource", "forms/common", "actions", "forms/resList", "forms/vacList"], function($H, ko, ds, common, Actions, resList, vacList){	function templateIn(){with($H){		return div({"class":"formPnl"},			div({"class":"section_title_noslash"}, "Вход"),			table({border:0, cellpadding:3, cellspacing:0},				tr(					td("Логин"),					td(input({type:"text", "data-bind":"value:login"})),					td()				),				tr(					td("Пароль"),					td(input({type:"password", "data-bind":"value:password"})),					td(input({type:"button", "data-bind":"click:logon", value:"Войти"}))				)			),			p({style:"text-align:right; margin-right:10px;"}, a({href:"#"}, "Зарегистрироваться"))		);	}}		function templateOut(data){with($H){		return div({"class":"formPnl"},			p("Добро пожаловать, ", data.userName, "!"),			p(input({type:"button", "data-bind":"click:logoff", value:"Выйти"})),			h3("Резюме"),			p(a({id:"allResume", href:"#"}, "Все резюме (", data.resCount,")")),			h3("Вакансии"),			p(a({id:"allVacancies", href:"#"}, "Все вакансии (", data.vacCount,")")),			hr(),			p(a({href:"#"}, "Личный кабинет"))		);	}}	var panel,		hdrPnl = $("#headerPanel"),		ticket;	function LogonModel(){var _=this;		_.login = ko.observable("");		_.password = ko.observable("");		_.logon = function(){			var data = {login:_.login(), password: _.password()};			common.wait(panel);			ds.logon(data, function(res){				panel.html(templateOut(res));				actions.bind("#allResume", "resList");				actions.bind("#allVacancies", "vacList");				ko.applyBindings(new LogoffModel(), panel.find(".formPnl")[0]);			});		}	}		function LogoffModel(){var _=this;		_.logoff = function(){			common.wait(panel);			ds.logoff(function(res){				panel.html(templateIn());				ko.applyBindings(new LogonModel(), panel.find(".formPnl")[0]);			});		}	}		var actions = new Actions({		resList: function(){			hdrPnl.html($H.h2("Управление резюме"));			resList.view($(".mainPanel"));		},		vacList: function(){			hdrPnl.html($H.h2("Управление вакансиями"));			vacList.view($(".mainPanel"));		}	});		return {		view: function(pnl){			panel = pnl;			pnl.html(templateIn());			ko.applyBindings(new LogonModel(), pnl.find(".formPnl")[0]);		},		ticket: ticket	};});